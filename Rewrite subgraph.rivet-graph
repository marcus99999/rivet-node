version: 4
data:
  metadata:
    description: ""
    id: 3soSwiUKQ_X4fGdokyxAH
    name: Rewrite subgraph
  nodes:
    '[3uWCPsym5lA_tSbQR8bCX]:text "Text"':
      data:
        text: |-
          {
            "data": {
              "history": [
              {
                {{newJSON}}
              },
                {{originalJSON}}
              ]
            }
          }
      outgoingConnections:
        - output->"Extract JSON" RLBF2blfneDpgAJzTpzjf/input
      visualData: 1449.1090185444375/1062.1963047209445/330/829//
    '[4IRH4YJ1BKdchejYhJkUO]:graphOutput "Graph Output"':
      data:
        dataType: object
        id: output
      visualData: 2376.3742299771907/1041.061261418121/330/834/var(--node-color-3)/var(--node-color-3)
    '[6nfmWOfUuvmxKv_aRlj3k]:chat "Chat"':
      data:
        additionalParameters: []
        cache: false
        enableFunctionUse: false
        headers: []
        maxTokens: 2048
        modalitiesIncludeAudio: false
        modalitiesIncludeText: false
        model: gpt-4o-mini
        outputUsage: false
        parallelFunctionCalling: true
        reasoningEffort: medium
        stop: ""
        temperature: 0.5
        top_p: 1
        useAdditionalParametersInput: false
        useAsGraphPartialOutput: true
        useFrequencyPenaltyInput: false
        useMaxTokensInput: false
        useModelInput: false
        usePredictedOutput: false
        usePresencePenaltyInput: false
        useReasoningEffortInput: false
        useServerTokenCalculation: true
        useStop: false
        useStopInput: false
        useTemperatureInput: false
        useTopP: false
        useTopPInput: false
        useUseTopPInput: false
        useUserInput: false
      outgoingConnections:
        - response->"Extract JSON" IeW5OiYv4h_tCjn3XT7LJ/input
        - response->"Text" 3uWCPsym5lA_tSbQR8bCX/newJSON
      visualData: 911.4331694633281/626.7246312924881/230/840//
    '[IeW5OiYv4h_tCjn3XT7LJ]:extractJson "Extract JSON"':
      visualData: 1315.3756166110195/499.3799727751199/280/838//
    '[RLBF2blfneDpgAJzTpzjf]:extractJson "Extract JSON"':
      outgoingConnections:
        - output->"Graph Output" 4IRH4YJ1BKdchejYhJkUO/value
      visualData: 1861.054080429073/1129.9133011951312/280/841//
    '[UIQtiQ7nK1T_wUjGMKQKA]:destructure "Destructure"':
      data:
        paths:
          - $.data.history[0].original
          - $.data.history
      outgoingConnections:
        - match_0->"Chat" 6nfmWOfUuvmxKv_aRlj3k/prompt
        - match_1->"Text" 3uWCPsym5lA_tSbQR8bCX/originalJSON
      visualData: 515.1787755046125/884.4391889762045/280/824//
    '[Xmbnoh9LlbLMA2d7kR3iV]:graphInput "Graph Input"':
      data:
        dataType: any
        id: input
        useDefaultValueInput: false
      outgoingConnections:
        - data->"Extract JSON" yZoOp6ik3X4HAKc_4WOzJ/input
      visualData: -272.92583538122926/716.0695657300618/330/839/var(--node-color-3)/var(--node-color-3)
    '[ah4enKZnetb-7VonC8qlx]:comment "Comment"':
      data:
        backgroundColor: rgba(218,4,4,0.05)
        color: rgba(154,2,2,1)
        height: 625.39387367782
        text: |-
          Combine into a larger JSON with previous outputs
          ONLY EVER COMBINING 2
          BECAUSE IT'S NOT REALLY PUSH / POPPING
      visualData: 1285.459610398486/901.3684380947511/981.2819192098432/823//
    '[bKoHjyTD-oOwlkBN5ksSL]:text "Text"':
      data:
        text: >-
          You are an agent who updates the content of a press releases if you
          believe it fails to meet best practice guidance.


          Best practice is defined as {{Bestpractice}}.


          You will be given a string of text and you will first analyse it to see how well it aligns to the best practice.


          If you believe it falls short of the direction and standards in the best practice then you will adjust the text in such a way that will better conform to the guidance.


          You should not rewrite the text entirely but just adjust or add small portions to make the text align better with the best practice guidance.


          You should also ensure that the updated text remains coherent.


          Use escaped line breaks when creating the copy in the format \n


          You will output the improved text.


          Additionally you will create a list of 3 bullet points that describe why it failed and 3 bullet points of how you have improved the text.


          Output the content in a string like this (don't convert to JSON):

              "original": "The original text passed to you in the prompt",
              "rewrite": "The updated, improved text",
              "fails": "3 bullet points of why it failed",
              "updates": "3 bullet points of how the text has been improved"
      outgoingConnections:
        - output->"Chat" 6nfmWOfUuvmxKv_aRlj3k/systemPrompt
      visualData: 467.3136351367133/175.93241167176447/330/569//
    '[lZUXWikwZ9xjE1pbYDB6g]:loadDataset "Load Dataset"':
      data:
        datasetId: xLJpaKaUKaZBupQgz34vW
      outgoingConnections:
        - dataset->"Text" bKoHjyTD-oOwlkBN5ksSL/Bestpractice
      visualData: 94.7476280850866/298.02005963527665/280/570//
    '[yZoOp6ik3X4HAKc_4WOzJ]:extractJson "Extract JSON"':
      outgoingConnections:
        - output->"Destructure" UIQtiQ7nK1T_wUjGMKQKA/object
      visualData: 123.48052711615514/872.1319057753815/280/837//
